################
# Initial Host Enumeration
################

## Currently active AV
wmic /namespace:\\root\securitycenter2 path antivirusproduct

## Local Accounts

wmic useraccount

  # Local User Accounts domain, name, and sid
  wmic useraccount get domain, name, sid

## Installed updates

wmic qfe list brief

  # Installed updates with URL link to KB details
  wmic qfe

###############
# wmic Post Exploitation Host Modifications
###############

## Enable Remote Desktop

wmic rdtoggle where AllowTSConnections="0" call SetAllowTSConnections "1"

  # Alternate Method for Enabling Remote Desktop
  wmic /node:remotehost path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"



################
# Domain Connected System Enumeration
################

## Domain and Domain Controller Details

wmic NTDOMAIN GET DomainControllerAddress,DomainName,Roles /VALUE

## List all Users from LDAP

wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samaccountname

## Specific Domain User Information from LDAP

wmic /NAMESPACE:\\root\directory\ldap PATH ds_user where "ds_samaccountname='testAccount'" /VALUE

## List All Groups from LDAP

wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samaccountname

## List All Members of a Specific Group from LDAP

wmic /NAMESPACE:\\root\directory\ldap PATH ds_group where "ds_samaccountname='Domain Admins'" GET ds_member /Value

## List All Members of a Specific Group Without Using LDAP Constrained Details; Returns Actual Windows logon/username

wmic path win32_groupuser where (groupcomponent="win32_group.name='domain admins', domain='TargetDomain'")

## List All Computers from LDAP

wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_dnshostname




###########################
# Example Outputs:


# C:\Windows\system32>wmic /namespace:\\root\securitycenter2 path antivirusproduct
# displayName       instanceGuid                            pathToSignedProductExe                       pathToSignedReportingExe                     productState  timestamp
# Windows Defender  {D68DDC3A-831F-4fae-9E44-DA132C1ACF46}  %ProgramFiles%\Windows Defender\MSASCui.exe  %ProgramFiles%\Windows Defender\MsMpeng.exe  397568        Wed, 05 Sep 2018 06:48:05 GMT
